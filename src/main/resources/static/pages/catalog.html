<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Katalog - Prime77</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/catalog.css">
</head>

<body>

<!-- Top Header (Desktop Only) -->
<div class="top-header">
    <div class="container-custom">
        <div class="row align-items-center">
            <div class="col-md-6"></div>
            <div class="col-md-6">
                <div class="d-flex align-items-center justify-content-end">
                    <div class="social-icons me-4">
                        <a href="#"><i class="fab fa-telegram-plane"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div>
                    <div>
                        <i class="fas fa-phone-alt me-2"></i>
                        <a href="tel:+998901234567">+998 90 123 45 67</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Header (Desktop Only) -->
<header class="main-header" id="main-header">
    <div class="container-custom">
        <div class="row align-items-center">
            <div class="col-lg-3">
                <h1 id="main-logo" style="font-weight: 700; font-size: 24px; margin: 0; color: var(--burgundy-dark);">PRIME<span style="color: #ff6b6b">77</span></h1>
            </div>
            <div class="col-lg-6">
                <nav class="navbar navbar-expand-lg">
                    <div class="collapse navbar-collapse justify-content-start">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" href="/index.html">BOSH SAHIFA</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="catalog.html">KATALOG</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="about.html">BIZ HAQIMIZDA</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="contact.html">KONTAKTLAR</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
            <div class="col-lg-3">
                <div class="d-flex justify-content-end align-items-center">
                    <div class="header-icons">
                        <a href="#" class="header-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                                <path d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path>
                            </svg>
                        </a>
                        <span class="header-separator">|</span>
                        <a href="#" class="header-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                                <path d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"></path>
                            </svg>
                        </a>
                        <div class="position-relative">
                            <a href="#" class="header-icon" id="cartIcon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                                    <path d="M239.89,198.12l-14.26-120a16,16,0,0,0-16-14.12H176a48,48,0,0,0-96,0H46.33a16,16,0,0,0-16,14.12l-14.26,120A16,16,0,0,0,20,210.6a16.13,16.13,0,0,0,12,5.4H223.92A16.13,16.13,0,0,0,236,210.6,16,16,0,0,0,239.89,198.12ZM128,32a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32ZM32,200,46.33,80H80v24a8,8,0,0,0,16,0V80h64v24a8,8,0,0,0,16,0V80h33.75l14.17,120Z"></path>
                                </svg>
                                <span class="badge" id="cartBadge">0</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Mobile Header (Mobile Only) -->
<div class="mobile-header">
    <div class="container">
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <h1 class="mobile-logo">PRIME<span>77</span></h1>
        <div class="mobile-header-icons">
            <a href="#" class="mobile-header-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                    <path d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"></path>
                </svg>
            </a>
        </div>
    </div>
</div>

<!-- Mobile Sidebar (Mobile Only) -->
<div class="mobile-sidebar" id="mobileSidebar">
    <div class="mobile-sidebar-overlay" id="mobileSidebarOverlay"></div>
    <div class="mobile-sidebar-content">
        <div class="mobile-sidebar-header">
            <h2 class="mobile-sidebar-title">PRIME<span>77</span></h2>
            <button class="mobile-sidebar-close" id="mobileSidebarClose">&times;</button>
        </div>
        <nav class="mobile-sidebar-nav">
            <a href="/index.html" class="mobile-nav-link">BOSH SAHIFA</a>
            <a href="catalog.html" class="mobile-nav-link">KATALOG</a>
            <a href="about.html" class="mobile-nav-link">BIZ HAQIMIZDA</a>
            <a href="contact.html" class="mobile-nav-link">KONTAKTLAR</a>
        </nav>
        <div class="mobile-sidebar-footer">
            <div class="mobile-contact">
                <i class="fas fa-phone-alt"></i>
                <span>+998 90 123 45 67</span>
            </div>
            <div class="mobile-social">
                <a href="#"><i class="fab fa-telegram-plane"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </div>
</div>

<!-- Cart Modal -->
<div class="cart-modal" id="cartModal">
    <div class="cart-modal-content">
        <div class="cart-header">
            <h3 class="cart-title">Savat</h3>
            <button class="cart-close" id="cartClose">&times;</button>
        </div>
        <div class="cart-body" id="cartBody">
            <div class="cart-empty" id="cartEmpty">
                <i class="fas fa-shopping-cart"></i>
                <p>Savat bo'sh</p>
                <small>Mahsulotlarni qo'shish uchun "Savatga qo'shish" tugmasini bosing</small>
            </div>
            <div class="cart-items" id="cartItems">
                <!-- Cart items will be populated by JavaScript -->
            </div>
        </div>
        <div class="cart-footer" id="cartFooter" style="display: none;">
            <div class="cart-total">
                <span>Jami:</span>
                <span class="cart-total-price" id="cartTotalPrice">0 So'm</span>
            </div>
            <button class="cart-checkout-btn" id="cartCheckoutBtn" disabled>
                Buyurtma berish
            </button>
        </div>
    </div>
</div>

<!-- Loading Spinner -->
<div class="loading-spinner" id="loadingSpinner" style="display: none;">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Yuklanmoqda...</span>
    </div>
</div>

<!-- Katalog Sahifa Kontenti -->
<main class="catalog-page">
    <div class="container-custom">
        <!-- Kategoriya Navigatsiyasi -->
        <div class="category-navigation">
            <div class="category-header">
                <h1 class="catalog-title">KATALOG</h1>
                <div class="category-breadcrumbs">
                    <a href="/index.html">Asosiy</a> > <span class="active-category" id="activeCategoryName">Barcha mahsulotlar</span>
                </div>
            </div>

            <div class="category-tabs" id="categoryTabs">
                <div class="category-tab active" data-category-id="all">Barchasi</div>
                <!-- Categories will be loaded dynamically -->
            </div>
        </div>

        <!-- Product Grid -->
        <div class="products-container">
            <div class="catalog-products-grid" id="productsGrid">
                <!-- Products will be loaded dynamically -->
            </div>

            <!-- No Products Message -->
            <div class="no-products" id="noProducts" style="display: none;">
                <div class="text-center py-5">
                    <i class="fas fa-box-open" style="font-size: 4rem; color: #ccc; margin-bottom: 20px;"></i>
                    <h3 style="color: var(--burgundy-dark);">Mahsulotlar topilmadi</h3>
                    <p style="color: #666;">Bu kategoriyada hozircha mahsulotlar mavjud emas.</p>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Mobile Bottom Navigation (Mobile Only) -->
<div class="mobile-bottom-nav">
    <div class="bottom-nav-item" id="categoriesBtn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect width="18" height="18" x="3" y="3" rx="2"></rect>
            <path d="M3 9h18"></path>
            <path d="M3 15h18"></path>
            <path d="M9 3v18"></path>
            <path d="M15 3v18"></path>
        </svg>
        <span>Kategoriyalar</span>
    </div>
    <div class="bottom-nav-item" id="mobileBottomCartBtn">
        <div class="bottom-nav-icon-container">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"></path>
                <path d="M3 6h18"></path>
                <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            <div class="bottom-nav-badge" id="bottomNavCartBadge">0</div>
        </div>
        <span>Savat</span>
    </div>
    <div class="bottom-nav-item" id="searchBtn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
            <path
                    d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z">
            </path>
        </svg>
        <span>Qidirish</span>
    </div>
</div>

<!-- Footer -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-6 col-6 mb-4">
                <h1 style="font-weight: 700; font-size: 24px; margin-bottom: 25px; color: #F5F5DC;">PRIME<span style="color: #ff6b6b">77</span></h1>
            </div>
            <div class="col-lg-2 col-md-6 col-6 mb-4">
                <h3 class="footer-title">KOMPANIYA</h3>
                <ul class="footer-links">
                    <li><a href="contact.html">Biz bilan bog'lanish</a></li>
                    <li><a href="about.html">Biz haqimizda</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-md-6 col-6 mb-4">
                <h3 class="footer-title">QO'LLAB-QUVVATLASH</h3>
                <ul class="footer-links">
                    <li><a href="#">Yetkazib berish</a></li>
                    <li><a href="#">FAQ</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-md-6 col-6 mb-4">
                <h3 class="footer-title">IJTIMOIY TARMOQLAR</h3>
                <div class="social-links">
                    <a href="#" class="social-link">
                        <i class="fab fa-telegram-plane"></i>
                        <span>Telegram</span>
                    </a>
                    <a href="#" class="social-link">
                        <i class="fab fa-instagram"></i>
                        <span>Instagram</span>
                    </a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="row">
                <div class="col-md-6">
                    <p>&copy; 2024 Prime77. All Rights Reserved.</p>
                </div>
                <div class="col-md-6 d-none d-md-block">
                    <div class="payment-methods">
                        <span>To'lov turlari:</span>
                        <div class="payment-images">
                            <img src="/images/click.webp" alt="Click" />
                            <img src="/images/payme.webp" alt="Payme" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

<script src="/js/script.js"></script>
<script>
    // ======================================================
    // API INTEGRATION FOR CATALOG
    // ======================================================

    // Global variables
    let categories = [];
    let products = [];
    let currentCategoryId = 'all';

    // Configure Axios defaults
    axios.defaults.timeout = 10000; // 10 seconds timeout
    axios.defaults.headers.common['Content-Type'] = 'application/json';

    // Add request interceptor for debugging
    axios.interceptors.request.use(
        config => {
            console.log('API Request:', config.method?.toUpperCase(), config.url);
            return config;
        },
        error => {
            console.error('Request Error:', error);
            return Promise.reject(error);
        }
    );

    // Add response interceptor for error handling
    axios.interceptors.response.use(
        response => {
            console.log('API Response:', response.status, response.config.url);
            return response;
        },
        error => {
            console.error('Response Error:', error.response?.status, error.response?.data || error.message);

            // Handle different error types
            if (error.code === 'ECONNABORTED') {
                showErrorMessage('Server bilan bog\'lanishda vaqt tugadi');
            } else if (error.response?.status === 404) {
                showErrorMessage('API endpoint topilmadi');
            } else if (error.response?.status >= 500) {
                showErrorMessage('Server xatoligi yuz berdi');
            } else if (!error.response) {
                showErrorMessage('Internet aloqasini tekshiring');
            }

            return Promise.reject(error);
        }
    );

    // API Base URL (you can change this to your actual API base URL)
    const API_BASE_URL = 'http://192.168.1.2/';

    // ======================================================
    // API FUNCTIONS
    // ======================================================

    // Fetch categories from API
    async function fetchCategories() {
        try {
            const response = await axios.get(`${API_BASE_URL}api/v1/categories`);
            categories = response.data;
            renderCategories();
        } catch (error) {
            console.error('Error fetching categories:', error);
            // Fallback to show error message or default categories
            showErrorMessage('Kategoriyalarni yuklashda xatolik yuz berdi');
        }
    }

    // Fetch all products from API
    async function fetchAllProducts() {
        try {
            showLoading(true);
            const response = await axios.get(`${API_BASE_URL}api/v1/products`);
            products = response.data;
            renderProducts(products);
            showLoading(false);
        } catch (error) {
            console.error('Error fetching products:', error);
            showLoading(false);
            showErrorMessage('Mahsulotlarni yuklashda xatolik yuz berdi');
        }
    }

    // Fetch products by category from API
    async function fetchProductsByCategory(categoryId) {
        try {
            showLoading(true);
            const response = await axios.get(`${API_BASE_URL}api/v1/products/by-category/${categoryId}`);
            products = response.data;
            renderProducts(products);
            showLoading(false);
        } catch (error) {
            console.error('Error fetching products by category:', error);
            showLoading(false);
            showErrorMessage('Mahsulotlarni yuklashda xatolik yuz berdi');
        }
    }

    // ======================================================
    // RENDER FUNCTIONS
    // ======================================================

    // Render categories
    function renderCategories() {
        const categoryTabs = document.getElementById('categoryTabs');

        // Clear existing tabs except "Barchasi"
        categoryTabs.innerHTML = '<div class="category-tab active" data-category-id="all">Barchasi</div>';

        // Add categories from API
        categories.forEach(category => {
            const categoryTab = document.createElement('div');
            categoryTab.className = 'category-tab';
            categoryTab.setAttribute('data-category-id', category.id);
            categoryTab.textContent = category.name;
            categoryTabs.appendChild(categoryTab);
        });

        // Add event listeners to category tabs
        initializeCategoryTabs();
    }

    // Render products
    function renderProducts(productsData) {
        const productsGrid = document.getElementById('productsGrid');
        const noProducts = document.getElementById('noProducts');

        if (!productsData || productsData.length === 0) {
            productsGrid.style.display = 'none';
            noProducts.style.display = 'block';
            return;
        }

        productsGrid.style.display = 'grid';
        noProducts.style.display = 'none';
        productsGrid.innerHTML = '';

        productsData.forEach(product => {
            const productCard = createProductCard(product);
            productsGrid.appendChild(productCard);
        });
    }

    // Create product card HTML
    function createProductCard(product) {
        const productCard = document.createElement('div');
        productCard.className = 'catalog-product-card';
        productCard.setAttribute('data-product-id', product.id);
        productCard.setAttribute('data-category', product.categoryName);

        // Calculate discount percentage
        const discountPercent = product.discount || 0;
        const originalPrice = product.price / (1 - discountPercent / 100);

        // Get main image URL
        const mainImageUrl = getImageUrl(product.attachmentIds[0]) || 'images/placeholder.jpg';

        // Get status badge
        const statusBadge = getStatusBadge(product.status);

        // Get available sizes
        const availableSizes = product.productSizes?.filter(size => size.amount > 0) || [];

        productCard.innerHTML = `
        <div class="catalog-product-image-container">
            ${discountPercent > 0 ? `
                <div class="catalog-discount-banner">
                    <div class="catalog-discount-text" data-text="ðŸ”¥ QAYNOQ CHEGIRMA ${discountPercent}% ðŸ”¥   "></div>
                </div>
            ` : ''}
            ${statusBadge}
            <img src="${mainImageUrl}" alt="${product.name}" class="catalog-product-image">
            <div class="catalog-quick-view-overlay">
                <span class="catalog-quick-view-text">QUICK VIEW</span>
            </div>
            <button class="catalog-mobile-quick-view-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256">
                    <path d="M247.31,124.76c-.35-.79-8.82-19.58-27.65-38.41C194.57,61.26,162.88,48,128,48S61.43,61.26,36.34,86.35C17.51,105.18,9,124,8.69,124.76a8,8,0,0,0,0,6.5c.35.79,8.82,19.57,27.65,38.4C61.43,194.74,93.12,208,128,208s66.57-13.26,91.66-38.34c18.83-18.83,27.3-37.61,27.65-38.4A8,8,0,0,0,247.31,124.76ZM128,192c-30.78,0-57.67-11.19-79.93-33.25A133.47,133.47,0,0,1,25,128,133.33,133.33,0,0,1,48.07,97.25C70.33,75.19,97.22,64,128,64s57.67,11.19,79.93,33.25A133.46,133.46,0,0,1,231.05,128C223.84,141.46,192.43,192,128,192Zm0-112a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Z"></path>
                </svg>
            </button>
        </div>
        <div class="catalog-product-info">
            <div class="catalog-product-category">${product.categoryName.toUpperCase()}</div>
            <h3 class="catalog-product-name">${product.name}</h3>
            ${product.attachmentIds && product.attachmentIds.length > 1 ? `
                <div class="catalog-product-thumbnails">
                    ${product.attachmentIds.slice(0, 2).map(id => `
                        <img src="${getImageUrl(id)}" alt="Thumbnail" class="catalog-product-thumbnail">
                    `).join('')}
                </div>
            ` : ''}
            <div class="catalog-product-pricing">
                <span class="catalog-current-price">${formatPrice(product.price)}</span>
                ${discountPercent > 0 ? `
                    <span class="catalog-original-price">${formatPrice(originalPrice)}</span>
                    <span class="catalog-discount-badge">-${discountPercent}%</span>
                ` : ''}
            </div>
            ${availableSizes.length > 0 ? `
                <div class="catalog-product-sizes">
                    <small>Mavjud o'lchamlar: ${availableSizes.map(s => s.size).join(', ')}</small>
                </div>
            ` : ''}
        </div>
    `;

        return productCard;
    }

    // ======================================================
    // UTILITY FUNCTIONS
    // ======================================================

    // Get image URL from attachment ID
    function getImageUrl(attachmentId) {
        if (!attachmentId) return 'images/placeholder.jpg';
        // You can modify this to match your actual image URL structure
        return API_BASE_URL + `api/v1/attachment/${attachmentId}`;
    }

    // Get status badge HTML
    function getStatusBadge(status) {
        if (!status || status === 'NORMAL') return '';

        const statusConfig = {
            'NEW': { text: 'YANGI', class: 'status-new', color: '#4CAF50' },
            'HOT': { text: 'ISSIQ', class: 'status-hot', color: '#FF5722' },
            'SALE': { text: 'CHEGIRMA', class: 'status-sale', color: '#FF9800' }
        };

        const config = statusConfig[status];
        if (!config) return '';

        return `
        <div class="product-status-badge ${config.class}" style="background: ${config.color};">
            ${config.text}
        </div>
    `;
    }

    // Format price
    function formatPrice(price) {
        return new Intl.NumberFormat('uz-UZ').format(price) + ' So\'m';
    }

    // Show loading spinner
    function showLoading(show) {
        const loadingSpinner = document.getElementById('loadingSpinner');
        const productsGrid = document.getElementById('productsGrid');

        if (show) {
            loadingSpinner.style.display = 'flex';
            productsGrid.style.opacity = '0.5';
        } else {
            loadingSpinner.style.display = 'none';
            productsGrid.style.opacity = '1';
        }
    }

    // Show error message
    function showErrorMessage(message) {
        const productsGrid = document.getElementById('productsGrid');
        productsGrid.innerHTML = `
        <div class="col-12">
            <div class="alert alert-danger text-center" role="alert">
                <i class="fas fa-exclamation-triangle mb-2" style="font-size: 2rem;"></i>
                <h4>Xatolik yuz berdi</h4>
                <p>${message}</p>
                <button class="btn btn-primary" onclick="location.reload()">Qayta yuklash</button>
            </div>
        </div>
    `;
    }

    // ======================================================
    // EVENT HANDLERS
    // ======================================================

    // Initialize category tabs
    function initializeCategoryTabs() {
        const categoryTabs = document.querySelectorAll('.category-tab');

        categoryTabs.forEach(tab => {
            tab.addEventListener('click', async () => {
                // Remove active class from all tabs
                categoryTabs.forEach(t => t.classList.remove('active'));

                // Add active class to clicked tab
                tab.classList.add('active');

                // Get category ID
                const categoryId = tab.getAttribute('data-category-id');
                currentCategoryId = categoryId;

                // Update active category name
                const activeCategoryName = document.getElementById('activeCategoryName');
                activeCategoryName.textContent = categoryId === 'all' ? 'Barcha mahsulotlar' : tab.textContent;

                // Fetch products
                if (categoryId === 'all') {
                    await fetchAllProducts();
                } else {
                    await fetchProductsByCategory(categoryId);
                }
            });
        });
    }

    // ======================================================
    // INITIALIZATION
    // ======================================================

    // Initialize catalog page
    document.addEventListener('DOMContentLoaded', async () => {
        // Load existing functionality
        if (typeof initializeMobileScrollEffects === 'function') {
            initializeMobileScrollEffects();
        }
        if (typeof initializeDesktopScrollEffects === 'function') {
            initializeDesktopScrollEffects();
        }
        if (typeof initializeMobileSidebar === 'function') {
            initializeMobileSidebar();
        }
        if (typeof initializeMobileBottomNav === 'function') {
            initializeMobileBottomNav();
        }
        if (typeof initializeCartModal === 'function') {
            initializeCartModal();
        }
        if (typeof loadCartFromStorage === 'function') {
            loadCartFromStorage();
        }

        // Load catalog data
        try {
            await Promise.all([
                fetchCategories(),
                fetchAllProducts()
            ]);
        } catch (error) {
            console.error('Error initializing catalog:', error);
            showErrorMessage('Sahifani yuklashda xatolik yuz berdi');
        }

        console.log('Catalog page initialized successfully!');
    });
</script>
</body>
</html>
